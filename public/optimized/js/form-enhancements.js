(function() { 'use strict'; console.log('Application Form Enhancements - Loading...'); const AGE_CONFIG = { MIN_AGE: 25, MAX_AGE: 70, ERROR_MESSAGE: { TOO_YOUNG: '지원 가능 최소 나이는 {MIN_AGE}세입니다. 현재 나이: {CURRENT_AGE}세', TOO_OLD: '지원 가능 최대 나이는 {MAX_AGE}세입니다. 현재 나이: {CURRENT_AGE}세', INVALID_DATE: '올바른 생년월일을 입력해주세요.', FUTURE_DATE: '미래 날짜는 입력할 수 없습니다.' } }; function calculateAge(birthDate) { const today = new Date(); const birth = new Date(birthDate); let age = today.getFullYear() - birth.getFullYear(); const monthDiff = today.getMonth() - birth.getMonth(); if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) { age--; } return age; } function validateAge(birthDate) { if (!birthDate) { return { valid: false, message: AGE_CONFIG.ERROR_MESSAGE.INVALID_DATE }; } const birth = new Date(birthDate); const today = new Date(); if (birth > today) { return { valid: false, message: AGE_CONFIG.ERROR_MESSAGE.FUTURE_DATE }; } const age = calculateAge(birthDate); if (age < AGE_CONFIG.MIN_AGE) { return { valid: false, message: AGE_CONFIG.ERROR_MESSAGE.TOO_YOUNG .replace('{MIN_AGE}', AGE_CONFIG.MIN_AGE) .replace('{CURRENT_AGE}', age) }; } if (age > AGE_CONFIG.MAX_AGE) { return { valid: false, message: AGE_CONFIG.ERROR_MESSAGE.TOO_OLD .replace('{MAX_AGE}', AGE_CONFIG.MAX_AGE) .replace('{CURRENT_AGE}', age) }; } return { valid: true, age: age }; } function showAgeError(input, message) { const existingError = input.parentElement.querySelector('.age-error'); if (existingError) { existingError.remove(); } const errorDiv = document.createElement('div'); errorDiv.className = 'age-error'; errorDiv.style.color = '#ef4444'; errorDiv.style.fontSize = '0.875rem'; errorDiv.style.marginTop = '0.25rem'; errorDiv.textContent = message; input.parentElement.appendChild(errorDiv); input.style.borderColor = '#ef4444'; } function clearAgeError(input) { const existingError = input.parentElement.querySelector('.age-error'); if (existingError) { existingError.remove(); } input.style.borderColor = ''; } function initTabSwitching() { const tabButtons = document.querySelectorAll('.tab-btn'); const formContents = document.querySelectorAll('.form-content'); if (tabButtons.length === 0) { console.log('No tab buttons found'); return; } function switchToTab(track) { tabButtons.forEach(btn => btn.classList.remove('active')); const targetButton = document.querySelector(`.tab-btn[data-track="${track}"]`); if (targetButton) { targetButton.classList.add('active'); } formContents.forEach(content => { content.classList.add('hidden'); content.classList.remove('active'); }); const targetContent = document.getElementById(`${track}-content`); if (targetContent) { targetContent.classList.remove('hidden'); targetContent.classList.add('active'); console.log('Switched to track:', track); } } tabButtons.forEach(button => { button.addEventListener('click', function(e) { e.preventDefault(); const track = this.getAttribute('data-track'); switchToTab(track); }); }); document.addEventListener('click', function(e) { const link = e.target.closest('a[data-track]'); if (link) { const track = link.getAttribute('data-track'); const applySection = document.getElementById('apply'); if (applySection) { e.preventDefault(); applySection.scrollIntoView({ behavior: 'smooth' }); setTimeout(() => { switchToTab(track); }, 500); } } }); console.log('Tab switching initialized:', tabButtons.length, 'tabs'); } function initBirthDateSelects() { const dateInputs = document.querySelectorAll('input[type="date"]'); if (dateInputs.length === 0) { console.log('No date inputs found'); return; } dateInputs.forEach(input => { if (input.dataset.converted) return; const inputId = input.id; const inputName = input.name; const required = input.hasAttribute('required'); const formGroup = input.closest('.form-group'); if (!formGroup) return; const selectContainer = document.createElement('div'); selectContainer.className = 'birth-date-selects'; selectContainer.style.display = 'flex'; selectContainer.style.gap = '0.5rem'; const yearSelect = createSelect( `${inputId}-year`, `${inputName}-year`, '년도', generateYears(), required ); const monthSelect = createSelect( `${inputId}-month`, `${inputName}-month`, '월', generateMonths(), required ); const daySelect = createSelect( `${inputId}-day`, `${inputName}-day`, '일', generateDays(), required ); selectContainer.appendChild(yearSelect); selectContainer.appendChild(monthSelect); selectContainer.appendChild(daySelect); const hiddenInput = document.createElement('input'); hiddenInput.type = 'hidden'; hiddenInput.id = inputId; hiddenInput.name = inputName; if (required) hiddenInput.required = true; input.parentNode.insertBefore(selectContainer, input); input.parentNode.insertBefore(hiddenInput, input); input.remove(); hiddenInput.dataset.converted = 'true'; function updateHiddenInput() { const year = yearSelect.value; const month = monthSelect.value; const day = daySelect.value; if (year && month && day) { const dateStr = `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`; hiddenInput.value = dateStr; const validation = validateAge(dateStr); if (!validation.valid) { showAgeError(selectContainer, validation.message); } else { clearAgeError(selectContainer); console.log(`Valid age: ${validation.age}세`); } } else { hiddenInput.value = ''; clearAgeError(selectContainer); } } yearSelect.addEventListener('change', updateHiddenInput); monthSelect.addEventListener('change', updateHiddenInput); daySelect.addEventListener('change', updateHiddenInput); function validateBirthDate() { const birthDate = hiddenInput.value; if (birthDate) { const result = validateAge(birthDate); if (!result.valid) { showAgeError(selectContainer, result.message); } else { clearAgeError(selectContainer); } } } yearSelect.addEventListener('change', validateBirthDate); monthSelect.addEventListener('change', validateBirthDate); daySelect.addEventListener('change', validateBirthDate); console.log('Birth date selects created for:', inputId); }); console.log('Birth date selects initialized'); } function createSelect(id, name, placeholder, options, required) { const select = document.createElement('select'); select.id = id; select.name = name; select.className = 'form-select'; if (required) select.required = true; const defaultOption = document.createElement('option'); defaultOption.value = ''; defaultOption.textContent = placeholder; select.appendChild(defaultOption); options.forEach(opt => { const option = document.createElement('option'); option.value = opt.value; option.textContent = opt.text; select.appendChild(option); }); return select; } function generateYears() { const years = []; const currentYear = new Date().getFullYear(); const startYear = 1940; const endYear = currentYear - 14; for (let year = endYear; year >= startYear; year--) { years.push({ value: year.toString(), text: year + '년' }); } return years; } function generateMonths() { const months = []; for (let month = 1; month <= 12; month++) { months.push({ value: month.toString(), text: month + '월' }); } return months; } function generateDays() { const days = []; for (let day = 1; day <= 31; day++) { days.push({ value: day.toString(), text: day + '일' }); } return days; } function initFormValidation() { const forms = document.querySelectorAll('.application-form'); forms.forEach(form => { form.addEventListener('submit', function(e) { let isValid = true; let errorMessage = ''; const activeContent = form.querySelector('.form-content:not(.hidden)'); if (!activeContent) return; const hiddenDateInputs = activeContent.querySelectorAll('input[type="hidden"][data-converted="true"]'); hiddenDateInputs.forEach(input => { if (!input.value && input.hasAttribute('required')) { isValid = false; errorMessage = '생년월일을 모두 선택해주세요.'; e.preventDefault(); return; } if (input.value) { const ageResult = validateAge(input.value); if (!ageResult.valid) { isValid = false; errorMessage = ageResult.message; const selectContainer = input.previousElementSibling; if (selectContainer && selectContainer.classList.contains('date-select-container')) { showAgeError(selectContainer, ageResult.message); } e.preventDefault(); return; } } }); if (!isValid && errorMessage) { alert(errorMessage); e.preventDefault(); return false; } console.log('Form validation passed'); }); }); console.log('Form validation initialized'); } function initPhoneFormatting() { const phoneInputs = document.querySelectorAll('input[type="tel"]'); phoneInputs.forEach(input => { input.addEventListener('input', function(e) { let value = e.target.value.replace(/[^0-9]/g, ''); if (value.length <= 3) { e.target.value = value; } else if (value.length <= 7) { e.target.value = value.slice(0, 3) + '-' + value.slice(3); } else if (value.length <= 11) { e.target.value = value.slice(0, 3) + '-' + value.slice(3, 7) + '-' + value.slice(7); } else { e.target.value = value.slice(0, 3) + '-' + value.slice(3, 7) + '-' + value.slice(7, 11); } }); }); console.log('Phone formatting initialized:', phoneInputs.length, 'inputs'); } function init() { if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', initializeFeatures); } else { initializeFeatures(); } } function initializeFeatures() { try { initTabSwitching(); initBirthDateSelects(); initFormValidation(); initPhoneFormatting(); console.log('Application Form Enhancements - All features loaded successfully! ✅'); } catch (error) { console.error('Error initializing application form features:', error); } } init(); })(); 